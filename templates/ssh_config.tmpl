# -*- conf -*-
# ssh_config

ForwardAgent {= $SSH_FORWARD_AGENT =}
HashKnownHosts no

{%- if [[ -n "${SSH_HOSTS[@]}" ]]; then -%}
{%- for spec in "${SSH_HOSTS[@]}"; do 
set $(echo $spec | sed 's/:/ /g')
host=$1 hostname=$2 proxy=$3 stanza=$4 %}
Host {= $host =}
{%- if [[ -n $hostname ]]; then %}
Hostname {= $hostname =}
{%- fi %}
{%- if [[ $proxy == fwknop-pw ]]; then %}
ProxyCommand {= $ZKIT =}/bin/run_pre_fwknop -p  {= $stanza =} %h %p
{%- fi %}
{%- if [[ $3 == fwknop-gpg ]]; then %}
ProxyCommand {= $ZKIT =}/bin/run_pre_fwknop {= $stanza =} %h %p
{%- fi %}
{% IFS=$' \t\n' %}
{%- done %}
{% fi %}
